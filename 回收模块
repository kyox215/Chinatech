<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iPhone Trade-In System (Time Depreciation)</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; }
        .glass-panel {
            background: rgba(255, 255, 255, 0.98);
            border: 1px solid rgba(0,0,0, 0.05);
            box-shadow: 0 4px 20px rgba(0,0,0,0.05);
        }
        .active-selection {
            border-color: #0f172a;
            background-color: #f1f5f9;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);
            transform: translateY(1px);
        }
        .lang-btn.active {
            background-color: #0f172a;
            color: white;
            font-weight: bold;
        }
        /* Trend Animation */
        .trend-down { color: #ef4444; animation: pulseRed 2s infinite; }
        @keyframes pulseRed { 0% { opacity: 1; } 50% { opacity: 0.6; } 100% { opacity: 1; } }
        .animate-slide-up { animation: slideUp 0.4s cubic-bezier(0.16, 1, 0.3, 1); }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    </style>
</head>
<body class="bg-slate-100 text-slate-800 min-h-screen">

<div id="root"></div>

<script type="text/babel">

    // ==========================================
    // ÁøªËØëÂ≠óÂÖ∏
    // ==========================================
    const translations = {
        it: {
            appTitle: "DEALER PRO",
            appSubtitle: "Sistema Intelligente (Deprezzamento Tempo)",
            date: "Data",
            configTitle: "1. Configurazione",
            batteryTitle: "2. Stato Batteria",
            conditionTitle: "3. Condizioni Estetiche",
            riskTitle: "4. Controllo Rischio / Tempo (Novit√†)",
            screenTitle: "5. Schermo LCD",
            finalPriceTitle: "Offerta Cash (Sicura)",
            basePrice: "Prezzo Base",
            capacity: "Capacit√†",
            batteryLoss: "Danno Batt.",
            conditionLoss: "Grado",
            depreciationLoss: "Svalutazione",
            screenLoss: "Schermo",
            screenBrokenQuestion: "Schermo Rotto?",
            markScreenBroken: "Clicca per segnare rotto",
            deduct: "Ded.",
            screenBrokenYes: "Rotto / Difettoso",
            confirmDeal: "Conferma Acquisto",
            printReceipt: "Stampa Ricevuta",
            noDeduction: "Perfetto",
            replaceCost: "Costo Ricambio",
            byValue: "Su Valore",
            holdPeriod: "Tempo di Vendita Previsto",
            days: "giorni",
            marketTrend: "Trend Mercato",
            nextMonthPred: "Previsione -30gg",
            fastDrop: "Crollo Rapido",
            stableDrop: "Calo Normale",
            slowDrop: "Calo Lento",
            
            // Battery
            bat_98: "Perfetto",
            bat_90: "Usura Lieve",
            bat_85: "Usura Evidente",
            bat_80: "Usura Grave",
            bat_bad: "Da Sostituire",

            // Condition
            cond_A: "Come Nuovo",
            cond_B: "Usato Poco",
            cond_C: "Segni Evidenti",
            cond_D: "Danneggiato",
        },
        en: {
            appTitle: "DEALER PRO",
            appSubtitle: "Smart System (Time Depreciation)",
            date: "Date",
            configTitle: "1. Configuration",
            batteryTitle: "2. Battery Health",
            conditionTitle: "3. Condition",
            riskTitle: "4. Risk Control / Hold Period (New)",
            screenTitle: "5. Screen Status",
            finalPriceTitle: "Safe Cash Offer",
            basePrice: "Base Price",
            capacity: "Capacity",
            batteryLoss: "Batt. Loss",
            conditionLoss: "Cond. Loss",
            depreciationLoss: "Time Risk",
            screenLoss: "Screen Value",
            screenBrokenQuestion: "Screen Broken?",
            markScreenBroken: "Click to mark broken",
            deduct: "Ded.",
            screenBrokenYes: "Broken / LCD Fault",
            confirmDeal: "Confirm Deal",
            printReceipt: "Print Receipt",
            noDeduction: "None",
            replaceCost: "Replace Cost",
            byValue: "By Value",
            holdPeriod: "Est. Time to Sell",
            days: "days",
            marketTrend: "Market Trend",
            nextMonthPred: "30-Day Forecast",
            fastDrop: "High Drop",
            stableDrop: "Stable Drop",
            slowDrop: "Low Drop",

            // Battery
            bat_98: "Perfect",
            bat_90: "Light Wear",
            bat_85: "Visible Wear",
            bat_80: "Heavy Wear",
            bat_bad: "Replace Needed",

            // Condition
            cond_A: "Like New",
            cond_B: "Lightly Used",
            cond_C: "Visible Damage",
            cond_D: "Heavy Damage",
        },
        zh: {
            appTitle: "ÂïÜÂÆ∂Êî∂Ë¥ßÁ≥ªÁªü",
            appSubtitle: "Êô∫ËÉΩÈ£éÊéßÁâà (Êó∂Èó¥Ë¥¨ÂÄºÁÆóÊ≥ï)",
            date: "Êó•Êúü",
            configTitle: "1. Êú∫ÂûãÈÖçÁΩÆ",
            batteryTitle: "2. ÁîµÊ±†ÂÅ•Â∫∑Â∫¶",
            conditionTitle: "3. Â§ñËßÇÊàêËâ≤",
            riskTitle: "4. Â∫ìÂ≠òÈ£éÈô© / Ë¥¨ÂÄºÊéßÂà∂ (Êñ∞Â¢û)",
            screenTitle: "5. Â±èÂπïÁä∂ÂÜµ",
            finalPriceTitle: "ÊúÄÁªàÂÆâÂÖ®Êî∂Ë¥ß‰ª∑",
            basePrice: "Âü∫ÂáÜ‰ª∑",
            capacity: "ÂÆπÈáè",
            batteryLoss: "ÁîµÊ±†ÊçüËÄó",
            conditionLoss: "ÊàêËâ≤ÊçüËÄó",
            depreciationLoss: "Â∫ìÂ≠òË∑å‰ª∑È£éÈô©",
            screenLoss: "Â±èÂπïÊÆãÂÄº",
            screenBrokenQuestion: "Â±èÂπïÊòØÂê¶ÊçüÂùè?",
            markScreenBroken: "ÁÇπÂáªÊ≠§Â§ÑÊ†áËÆ∞‰∏∫ÊçüÂùè",
            deduct: "Êâ£",
            screenBrokenYes: "ÊçüÂùè / ÊºèÊ∂≤ / Êñ≠Ëß¶",
            confirmDeal: "Á°ÆËÆ§Êàê‰∫§",
            printReceipt: "ÊâìÂç∞Êî∂ÊçÆ",
            noDeduction: "Êó†Êâ£Ê¨æ",
            replaceCost: "Êâ£Êç¢ÁîµË¥π",
            byValue: "Êåâ‰ª∑ÂÄºÊâ£",
            holdPeriod: "È¢ÑËÆ°Âë®ËΩ¨/ÂîÆÂá∫Êó∂Èó¥",
            days: "Â§©",
            marketTrend: "Â∏ÇÂú∫Ë∂ãÂäø",
            nextMonthPred: "‰∏ãÊúàË∑å‰ª∑È¢ÑÊµã",
            fastDrop: "È´ò‰ΩçË∑≥Ê∞¥",
            stableDrop: "Á®≥ÂÆö‰∏ãË∑å",
            slowDrop: "ÁºìÊÖ¢Ë¥¨ÂÄº",

            // Battery
            bat_98: "ÊûÅÂìÅÁä∂ÊÄÅ",
            bat_90: "ËΩªÂæÆÊçüËÄó",
            bat_85: "ÊòéÊòæËÄÅÂåñ",
            bat_80: "‰∏•ÈáçËÄÅÂåñ",
            bat_bad: "ÂøÖÈúÄÊõ¥Êç¢",

            // Condition
            cond_A: "ÂÆåÁæéÂÖÖÊñ∞",
            cond_B: "ËΩªÂæÆ‰ΩøÁî®",
            cond_C: "ÊòéÊòæÁ£ïÁ¢∞",
            cond_D: "‰∏•ÈáçÊàòÊçü",
        }
    };

    // ==========================================
    // Ê†∏ÂøÉÊï∞ÊçÆ (Âê´Âπ¥‰ªΩÁî®‰∫éËÆ°ÁÆóË∑å‰ª∑)
    // ==========================================
    // ÂÅáËÆæÂΩìÂâçÂπ¥‰ªΩ 2026 (Âü∫‰∫é iPhone 17 Â≠òÂú®)
    const currentYear = 2026; 

    const initialCsvData = `Model,ScreenPrice,BatteryPrice,BaseRecyclePrice,ReleaseYear
iPhone 17 Pro Max,499,139,800,2025
iPhone 17 Pro,419,139,700,2025
iPhone 17 Plus,419,109,580,2025
iPhone 17,419,109,520,2025
iPhone 16 Pro Max,499,139,680,2024
iPhone 16 Pro,419,139,580,2024
iPhone 16 Plus,419,109,480,2024
iPhone 16,349,109,400,2024
iPhone 15 Pro Max,499,109,580,2023
iPhone 15 Pro,419,109,480,2023
iPhone 15 Plus,419,109,380,2023
iPhone 15,349,109,320,2023
iPhone 14 Pro Max,499,109,480,2022
iPhone 14 Pro,419,109,400,2022
iPhone 14 Plus,419,109,280,2022
iPhone 14,349,109,250,2022
iPhone 13 Pro Max,419,99,350,2021
iPhone 13 Pro,349,99,300,2021
iPhone 13,349,99,200,2021
iPhone 13 mini,289,99,150,2021
iPhone 12 Pro Max,419,99,250,2020
iPhone 12 Pro,349,99,200,2020
iPhone 12,349,99,150,2020
iPhone 12 mini,289,99,100,2020
iPhone 11 Pro Max,419,99,160,2019
iPhone 11 Pro,349,99,130,2019
iPhone 11,249,99,90,2019`;

    const storageTiers = [
        { label: "64G / 128G", value: 0 },
        { label: "256G", value: 15 },
        { label: "512G", value: 30 },
        { label: "1TB", value: 50 }
    ];

    const parseCSV = (csvText) => {
        const lines = csvText.trim().split('\n');
        return lines.slice(1).map(line => {
            const values = line.split(',');
            return {
                model: values[0],
                screenPrice: parseFloat(values[1]),
                batteryPrice: parseFloat(values[2]),
                baseRecyclePrice: parseFloat(values[3]),
                releaseYear: parseInt(values[4])
            };
        });
    };

    const App = () => {
        const [lang, setLang] = React.useState('it'); 
        const t = translations[lang];
        const [data, setData] = React.useState([]);
        
        // Selections
        const [selectedModel, setSelectedModel] = React.useState(null);
        const [selectedStorage, setSelectedStorage] = React.useState(storageTiers[0]);
        const [isScreenBroken, setIsScreenBroken] = React.useState(false);
        const [holdDays, setHoldDays] = React.useState(7); // Default 7 days holding

        // Dynamic Options
        const conditionGrades = React.useMemo(() => [
            { id: 'A', label: t.cond_A, deductionPercent: 0, color: "text-green-600" },
            { id: 'B', label: t.cond_B, deductionPercent: 0.05, color: "text-blue-600" },
            { id: 'C', label: t.cond_C, deductionPercent: 0.15, color: "text-orange-600" },
            { id: 'D', label: t.cond_D, deductionPercent: 0.30, color: "text-red-600" }
        ], [lang]);

        const batteryLevels = React.useMemo(() => [
            { label: "98% - 100%", desc: t.bat_98, type: 'percent', value: 0 },
            { label: "90% - 97%", desc: t.bat_90, type: 'percent', value: 0.03 },
            { label: "85% - 89%", desc: t.bat_85, type: 'percent', value: 0.06 },
            { label: "80% - 84%", desc: t.bat_80, type: 'percent', value: 0.10 },
            { label: "< 80% / Rep.", desc: t.bat_bad, type: 'fixed', value: 1.0 }
        ], [lang]);

        const [selectedCondition, setSelectedCondition] = React.useState(null);
        const [selectedBattery, setSelectedBattery] = React.useState(null);

        React.useEffect(() => {
            const parsedData = parseCSV(initialCsvData);
            setData(parsedData);
            if(parsedData.length > 0) setSelectedModel(parsedData[0]);
        }, []);

        React.useEffect(() => {
            if (!selectedCondition) setSelectedCondition(conditionGrades[0]);
            else setSelectedCondition(conditionGrades.find(g => g.id === selectedCondition.id) || conditionGrades[0]);

            if (!selectedBattery) setSelectedBattery(batteryLevels[0]);
            else {
                const prefix = selectedBattery.label.split(' ')[0];
                setSelectedBattery(batteryLevels.find(b => b.label.startsWith(prefix)) || batteryLevels[0]);
            }
        }, [lang, conditionGrades, batteryLevels]);

        // ==========================================
        // Ê†∏ÂøÉÁÆóÊ≥ïÔºöÊó∂Èó¥Ë¥¨ÂÄº (Depreciation Logic)
        // ==========================================
        const getDepreciationInfo = () => {
            // FIX: Ensure default object structure contains 'color' to prevent undefined error
            if (!selectedModel) return { monthlyRate: 0, label: t.stableDrop, color: "text-gray-400" };
            
            // Calculate age in years
            const age = currentYear - selectedModel.releaseYear;
            
            // Monthly Decay Rate (ÊØèÊúàË∑å‰ª∑Áéá)
            let monthlyRate = 0.015; // Default 1.5%
            let label = t.stableDrop;
            let color = "text-yellow-600";

            if (age <= 1) { 
                monthlyRate = 0.025; // Êñ∞Ê¨æÊéâ‰ª∑Âø´ (2.5%)
                label = t.fastDrop;
                color = "text-red-600";
            } else if (age >= 3) {
                monthlyRate = 0.010; // ËÄÅÊ¨æÊéâ‰ª∑ÊÖ¢ (1.0%)
                label = t.slowDrop;
                color = "text-green-600";
            }

            return { monthlyRate, label, color };
        };

        const calculateQuote = () => {
            if (!selectedModel || !selectedCondition || !selectedBattery) return 0;
            
            // 1. Âü∫ÂáÜ
            let price = selectedModel.baseRecyclePrice + selectedStorage.value;
            const baseForCalc = price;

            // 2. Êâ£ÊàêËâ≤
            price -= baseForCalc * selectedCondition.deductionPercent;

            // 3. Êâ£ÁîµÊ±†
            if (selectedBattery.type === 'percent') {
                price -= baseForCalc * selectedBattery.value;
            } else {
                price -= selectedModel.batteryPrice;
            }

            // 4. Êâ£Â±èÂπï
            if (isScreenBroken) price -= selectedModel.screenPrice;

            // 5. Êâ£Êó∂Èó¥/Â∫ìÂ≠òÈ£éÈô© (Depreciation) - Êñ∞Â¢û
            const { monthlyRate } = getDepreciationInfo();
            // Formula: Price * (MonthlyRate / 30 * HoldDays)
            // Example: 2% rate, hold 30 days = -2% value
            const depreciationAmount = price * (monthlyRate / 30 * holdDays);
            price -= depreciationAmount;

            return price < 10 ? 10 : Math.floor(price);
        };

        const finalQuote = calculateQuote();
        const basePrice = selectedModel ? (selectedModel.baseRecyclePrice + selectedStorage.value) : 0;
        const depInfo = getDepreciationInfo();
        
        // ËÆ°ÁÆóË¥¨ÂÄºÈáëÈ¢ùÁî®‰∫éÊòæÁ§∫
        const calcDepreciationCost = () => {
            if (!selectedModel) return 0;
            // ÁÆÄÂçï‰º∞ÁÆóÔºåÂü∫‰∫éÂΩìÂâç‰ª∑Ê†º
            const tempPrice = basePrice * (1 - selectedCondition.deductionPercent); // Á≤óÁï•Âü∫Êï∞
            return Math.floor(tempPrice * (depInfo.monthlyRate / 30 * holdDays));
        };
        const depreciationCost = calcDepreciationCost();

        // È¢ÑÊµã‰∏ã‰∏™Êúà‰ª∑Ê†º (Forecast)
        const nextMonthPrice = Math.floor(finalQuote * (1 - depInfo.monthlyRate));

        return (
            <div className="max-w-6xl mx-auto p-4 font-sans text-slate-800 animate-slide-up">
                
                {/* Header */}
                <div className="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
                    <div className="flex items-center gap-3">
                        <div className="bg-slate-900 text-white px-3 py-1 rounded text-sm font-bold tracking-wider">
                            {t.appTitle}
                        </div>
                        <span className="text-xs font-bold text-slate-500 uppercase">{t.appSubtitle}</span>
                    </div>
                    
                    <div className="flex items-center gap-2">
                         <div className="bg-white p-1 rounded-lg border border-slate-200 flex text-xs font-medium">
                            {['it', 'en', 'zh'].map(l => (
                                <button key={l} onClick={() => setLang(l)} className={`px-3 py-1.5 rounded-md transition-all lang-btn ${lang === l ? 'active' : 'text-slate-500 hover:bg-slate-50'}`}>
                                    {l === 'it' ? 'üáÆüáπ IT' : l === 'en' ? 'üá¨üáß EN' : 'üá®üá≥ CN'}
                                </button>
                            ))}
                        </div>
                    </div>
                </div>

                <div className="grid lg:grid-cols-12 gap-6">
                    
                    {/* Â∑¶‰æßÈÖçÁΩÆÂå∫ */}
                    <div className="lg:col-span-8 flex flex-col gap-4">
                        
                        {/* 1. Êú∫Âûã */}
                        <div className="glass-panel p-6 rounded-xl relative overflow-hidden">
                            <div className="flex justify-between items-center mb-4 relative z-10">
                                <h3 className="text-xs font-bold text-slate-400 uppercase tracking-widest">{t.configTitle}</h3>
                                <div className="flex bg-slate-100 p-1 rounded-lg">
                                    {storageTiers.map((tier) => (
                                        <button key={tier.label} onClick={() => setSelectedStorage(tier)} className={`px-3 py-1 text-xs font-bold rounded-md transition-all ${selectedStorage.value === tier.value ? 'bg-white text-black shadow-sm' : 'text-slate-400 hover:text-slate-600'}`}>
                                            {tier.label.split('/')[0]}
                                        </button>
                                    ))}
                                </div>
                            </div>
                            <select className="w-full p-3 text-xl font-bold bg-white border border-slate-200 rounded-xl outline-none appearance-none relative z-10" onChange={(e) => setSelectedModel(data.find(m => m.model === e.target.value))} value={selectedModel?.model || ''}>
                                {data.map(m => <option key={m.model} value={m.model}>{m.model}</option>)}
                            </select>
                            
                            {/* Ë∂ãÂäøÊ†áÁ≠æ */}
                            <div className={`absolute top-0 right-0 px-4 py-2 text-[10px] font-bold uppercase rounded-bl-xl z-0 bg-opacity-10 ${depInfo.color.replace('text', 'bg')} ${depInfo.color}`}>
                                {t.marketTrend}: {depInfo.label} (-{(depInfo.monthlyRate*100).toFixed(1)}%/mo)
                            </div>
                        </div>

                        {/* 4. È£éÈô©ÊéßÂà∂ (Risk Control) - Ê†∏ÂøÉÊñ∞Â¢û */}
                        <div className="glass-panel p-6 rounded-xl border-l-4 border-l-slate-800">
                            <h3 className="text-xs font-bold text-slate-500 uppercase tracking-widest mb-4 flex items-center">
                                <i className="fas fa-chart-line mr-2"></i> {t.riskTitle}
                            </h3>
                            
                            <div className="flex flex-col gap-4">
                                <div className="flex justify-between items-end">
                                    <label className="text-sm font-bold text-slate-700">{t.holdPeriod}</label>
                                    <span className="text-2xl font-bold text-slate-900">{holdDays} <span className="text-xs font-normal text-slate-500">{t.days}</span></span>
                                </div>
                                
                                <input 
                                    type="range" min="0" max="60" step="1" 
                                    value={holdDays}
                                    onChange={(e) => setHoldDays(Number(e.target.value))}
                                    className="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-slate-900"
                                />
                                
                                <div className="flex justify-between text-[10px] text-slate-400 font-mono">
                                    <span>0 {t.days} (Quick)</span>
                                    <span>30 {t.days}</span>
                                    <span>60 {t.days} (Slow)</span>
                                </div>

                                {depreciationCost > 0 && (
                                    <div className="bg-slate-100 p-3 rounded-lg flex justify-between items-center text-xs">
                                        <span className="text-slate-500"><i className="fas fa-shield-alt mr-1"></i> {t.depreciationLoss}</span>
                                        <span className="font-bold text-red-600">- ‚Ç¨{depreciationCost}</span>
                                    </div>
                                )}
                            </div>
                        </div>

                        {/* 2. ÁîµÊ±† */}
                        <div className="glass-panel p-6 rounded-xl bg-slate-50 border border-slate-200">
                            <h3 className="text-xs font-bold text-slate-500 uppercase tracking-widest mb-4">{t.batteryTitle}</h3>
                            <div className="grid grid-cols-5 gap-2">
                                {batteryLevels.map((level, idx) => (
                                    <div key={idx} onClick={() => setSelectedBattery(level)} className={`p-2 rounded-lg border-2 cursor-pointer transition-all flex flex-col items-center justify-center text-center ${selectedBattery?.label === level.label ? 'active-selection border-black' : 'border-slate-200 bg-white'}`}>
                                        <div className="font-bold text-xs mb-1">{level.label}</div>
                                        <div className={`text-[10px] font-mono font-bold ${level.value===0 ? 'text-green-600':'text-red-500'}`}>{level.value===0 ? 'OK' : `-${level.value*100}%`}</div>
                                    </div>
                                ))}
                            </div>
                        </div>

                        {/* 3. Â§ñËßÇ & Â±èÂπï */}
                        <div className="grid md:grid-cols-2 gap-4">
                            <div className="glass-panel p-6 rounded-xl">
                                <h3 className="text-xs font-bold text-slate-400 uppercase tracking-widest mb-4">{t.conditionTitle}</h3>
                                <div className="space-y-2">
                                    {conditionGrades.map((grade) => (
                                        <div key={grade.id} onClick={() => setSelectedCondition(grade)} className={`flex justify-between p-3 rounded-lg border cursor-pointer ${selectedCondition?.id === grade.id ? 'bg-slate-900 text-white' : 'bg-white border-slate-100 hover:bg-slate-50'}`}>
                                            <span className="text-sm font-bold">{grade.label}</span>
                                            <span className="text-xs opacity-70">{grade.deductionPercent===0 ? 'OK' : `-${grade.deductionPercent*100}%`}</span>
                                        </div>
                                    ))}
                                </div>
                            </div>
                            <div className="glass-panel p-6 rounded-xl flex flex-col">
                                <h3 className="text-xs font-bold text-slate-400 uppercase tracking-widest mb-4">{t.screenTitle}</h3>
                                <div onClick={() => setIsScreenBroken(!isScreenBroken)} className={`flex-1 rounded-xl border-2 cursor-pointer flex flex-col items-center justify-center p-4 text-center ${isScreenBroken ? 'border-red-500 bg-red-50 text-red-700' : 'border-slate-100 bg-white text-slate-400'}`}>
                                    <i className="fas fa-mobile-alt text-2xl mb-2"></i>
                                    <div className="font-bold text-sm">{isScreenBroken ? t.screenBrokenYes : t.screenBrokenQuestion}</div>
                                </div>
                            </div>
                        </div>

                    </div>

                    {/* Âè≥‰æßÔºöÊä•‰ª∑Âçï */}
                    <div className="lg:col-span-4 flex flex-col">
                        <div className="glass-panel rounded-xl p-6 bg-slate-900 text-white flex-1 flex flex-col relative overflow-hidden shadow-2xl">
                            
                            <div className="mt-2 text-center border-b border-white/10 pb-6 relative z-10">
                                <div className="text-slate-400 text-xs font-bold uppercase tracking-wider mb-2">{t.finalPriceTitle}</div>
                                <div className="flex items-center justify-center">
                                    <span className="text-3xl font-bold mr-1 text-green-500">‚Ç¨</span>
                                    <span className="text-7xl font-bold tracking-tighter leading-none">{finalQuote}</span>
                                </div>
                                {/* È¢ÑÊµã‰∏ãÊúà‰ª∑Ê†º */}
                                <div className="mt-4 text-xs bg-white/5 rounded px-2 py-1 inline-block">
                                    <span className="opacity-60 mr-2">{t.nextMonthPred}:</span>
                                    <span className="font-mono text-yellow-400 font-bold">‚Ç¨ {nextMonthPrice}</span>
                                    <span className="ml-1 trend-down text-[10px]">‚Üì</span>
                                </div>
                            </div>

                            <div className="space-y-3 mt-6 flex-1 text-sm relative z-10 overflow-y-auto max-h-[350px] scrollbar-hide">
                                <div className="flex justify-between opacity-70 py-1"><span>{t.basePrice}</span><span className="font-mono">‚Ç¨ {basePrice}</span></div>
                                
                                {depreciationCost > 0 && (
                                    <div className="flex justify-between text-red-300 py-1 border-b border-white/5 bg-red-900/20 px-1 -mx-1 rounded">
                                        <span>- {t.depreciationLoss} ({holdDays}d)</span>
                                        <span className="font-mono">- {depreciationCost}</span>
                                    </div>
                                )}
                                
                                {selectedBattery?.value > 0 && (
                                    <div className="flex justify-between text-blue-300 py-1 border-b border-white/5">
                                        <span>- {t.batteryLoss} ({selectedBattery.type==='fixed'?'Fix':'%'})</span>
                                        <span className="font-mono">- {selectedBattery.type==='percent' ? Math.floor(basePrice*selectedBattery.value) : selectedModel.batteryPrice}</span>
                                    </div>
                                )}
                                
                                {selectedCondition?.deductionPercent > 0 && (
                                    <div className="flex justify-between text-yellow-300 py-1 border-b border-white/5">
                                        <span>- {t.conditionLoss} ({selectedCondition.id})</span>
                                        <span className="font-mono">- {Math.floor(basePrice * selectedCondition.deductionPercent)}</span>
                                    </div>
                                )}
                                
                                {isScreenBroken && (
                                    <div className="flex justify-between text-red-400 py-1 border-b border-white/5">
                                        <span>- {t.screenLoss}</span>
                                        <span className="font-mono">- {selectedModel.screenPrice}</span>
                                    </div>
                                )}
                            </div>

                            <div className="mt-auto relative z-10 pt-4">
                                <button className="w-full bg-green-600 hover:bg-green-500 text-white py-4 rounded-xl font-bold text-lg shadow-lg active:scale-95 flex items-center justify-center gap-2 group">
                                    <span className="group-hover:hidden">{t.confirmDeal}</span>
                                    <span className="hidden group-hover:inline">{t.printReceipt}</span>
                                    <i className="fas fa-arrow-right"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
</script>

</body>
</html>