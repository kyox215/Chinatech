# 数据库架构规划方案

我将为您创建一个详细的数据库架构指南 (`docs/DATABASE_ARCHITECTURE.md`)，为多应用数据管理建立统一规则。

## 1. 命名规范 (命名空间策略)
- **规则**: 所有特定应用的表必须加上该应用的唯一标识符作为前缀。
- **格式**: `[应用ID]_[实体名称]`
- **示例**:
    - 回收报价应用: `recycling_models` (机型), `recycling_orders` (订单)
    - 设计应用: `design_projects` (项目), `design_assets` (素材)
    - 核心/共享层: `core_profiles` (用户资料), `core_logs` (系统日志)

## 2. 架构设计
- **核心层 (Core Layer)**:
    - `auth.users`: Supabase 原生用户表，作为所有数据的核心身份锚点。
    - `core_profiles`: 扩展的用户信息表（如昵称、头像），供所有应用读取。
- **应用层 (App Layer)**:
    - 每个应用拥有独立的表集合，互不干扰。
    - 通过 `user_id` (UUID) 外键关联到核心层，实现数据互通。
- **数据关联 (Cross-App)**:
    - **读取**: 应用A可以通过 `JOIN` 核心表来获取用户信息。
    - **写入**: 应用A 只能写入自己的表 (`appA_table`)，不能直接修改 应用B 的表。

## 3. 执行步骤
1.  **创建文档**: 编写 `docs/DATABASE_ARCHITECTURE.md`，详细说明命名规范、外键关联规则和 RLS (行级安全) 策略。
2.  **Schema 示例**: 在文档中提供标准的 SQL 建表语句模版，展示如何创建一个新应用的表并关联到用户系统。
3.  **管理规划**: 规划未来如何通过统一的后台视图（基于 `core_logs` 和各应用表）来管理不同应用的数据。

这个方案能确保在未来扩展到十几个应用（如 PixelMaster, VideoStudio）时，数据库依然井井有条，且能轻松生成跨应用的用户画像报表。